import{i as o,w as i}from"./wait-BlTzaSj7.js";/**
 * Invoice Ninja (https://invoiceninja.com).
 *
 * @link https://github.com/invoiceninja/invoiceninja source repository
 *
 * @copyright Copyright (c) 2021. Invoice Ninja LLC (https://invoiceninja.com)
 *
 * @license https://www.elastic.co/licensing/elastic-license 
 */class m{constructor(){this.clientSecret=document.querySelector("meta[name=stripe-pi-client-secret]")?.content}init(){let e={};return document.querySelector("meta[name=stripe-account-id]")&&(e.apiVersion="2020-08-27",e.stripeAccount=document.querySelector("meta[name=stripe-account-id]")?.content),this.stripe=Stripe(document.querySelector("meta[name=stripe-publishable-key]")?.content,e),this.elements=this.stripe.elements(),this}createPaymentRequest(){return this.paymentRequest=this.stripe.paymentRequest(JSON.parse(document.querySelector("meta[name=payment-request-data").content)),this}createPaymentRequestButton(){this.paymentRequestButton=this.elements.create("paymentRequestButton",{paymentRequest:this.paymentRequest})}handlePaymentRequestEvents(e,s){document.querySelector("#errors").hidden=!0,this.paymentRequest.on("paymentmethod",function(t){e.confirmCardPayment(s,{payment_method:t.paymentMethod.id},{handleActions:!1}).then(function(n){n.error?(document.querySelector("#errors").innerText=n.error.message,document.querySelector("#errors").hidden=!1,t.complete("fail")):(t.complete("success"),n.paymentIntent.status==="requires_action"?e.confirmCardPayment(s).then(function(r){r.error?(t.complete("fail"),document.querySelector("#errors").innerText=r.error.message,document.querySelector("#errors").hidden=!1):(document.querySelector('input[name="gateway_response"]').value=JSON.stringify(r.paymentIntent),document.getElementById("server-response").submit())}):(document.querySelector('input[name="gateway_response"]').value=JSON.stringify(n.paymentIntent),document.getElementById("server-response").submit()))})})}handle(){this.init().createPaymentRequest().createPaymentRequestButton(),this.paymentRequest.canMakePayment().then(e=>{if(e)return this.paymentRequestButton.mount("#payment-request-button");document.querySelector("#errors").innerHTML=JSON.parse(document.querySelector("meta[name=no-available-methods]")?.content),document.querySelector("#errors").hidden=!1}),this.handlePaymentRequestEvents(this.stripe,this.clientSecret)}}function a(){new m().handle()}o()?a():i("#stripe-browserpay-payment").then(()=>a());
